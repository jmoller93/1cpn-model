# Ellipsoid Diffusion

units	     lj
dimension    3
boundary     p p p

# atom style, potential type:
atom_style   hybrid ellipsoid full

# Random number seed for orientation
variable random equal 12345

# Simulation Temperature
variable T equal 1.0

# Specify the different interaction styles
bond_style	  harmonic
angle_style	  hybrid wlctwist cosine

# Read in the configuration
read_data in.lammps

# GB parameters:
pair_style     lj/cut    1.0

#Bond Coeffs
bond_coeff   1   125.1   1.00

#Angle Coeffs
angle_coeff	1	cosine        48.6                      # bead-bead bend
angle_coeff	2	wlctwist	1000.0	  63.2    0.00  # bead-bead twist

# set parameters:
set 	     type 1 mass 1.0
set 	     type 1 shape 1.0 1.0 1.0

## potential parameters:
pair_coeff   1 1  0.0   1.0 

################################################################

timestep     0.001

# Initialize velocities from a Gaussian distribution
# velocity all create ${T} ${random} rot yes mom yes dist gaussian


fix 1 all   nve/asphere
#fix 2 all   langevin   ${T} ${T} 0.00217256 ${random} angmom 3.33333

compute	q all property/atom quatw quati quatj quatk
compute rot all erotate/asphere
compute mom all property/atom vx vy vz
compute amom all property/atom angmomx angmomy angmomz
variable mystep equal step
variable myerot equal c_rot
variable myetot equal etotal+0.5*c_rot
fix 6 all ave/time 1000 1 1000 c_rot v_myetot file energy.dat
#fix 7 all ave/time 1000 1 1000 mass vx vy vz c_amom[1] c_amom[2] c_amom[3] file momentum.dat

# dump trajectory during corrent iteration:
dump	     1 all custom 100 traj.dump id type x y z c_q[1] c_q[2] c_q[3] c_q[4]
# dump to check linear and angular momentum are conserved
dump	     2 all custom 1000 traj-angmom.dump id type x y z c_amom[1] c_amom[2] c_amom[3] mass vx vy vz

# dump trajectory during corrent iteration:
thermo_style custom step etotal v_myetot c_rot pe eangle ebond epair

thermo	     100000
thermo_modify flush yes

reset_timestep   0
run	    1000000
